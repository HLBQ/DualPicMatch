# DualPicMatch-(图片查重工具)Image deduplication tool
<img width="1200" height="800" alt="ScreenShot_2026-02-25_174409_383" src="https://github.com/user-attachments/assets/a2e9d9b4-7e78-4424-9b5a-35119d8c0779" />


## ⭐开门见山（打包版本,详情见后面）


### 使用
1. 下载最新的打包版本（通常为 `.exe` 文件）
2. 将可执行文件放置在要检测的文件夹根目录
3. 双击运行即可开始使用
4. 点击扫描图片，等待扫描完成
5. 点击开始比对，等待扫描完成
6. 找到顶部栏的重复图片，点击之后即可查看重复图片检测结果



## ⭐产品简介

图片查重工具是一款基于深度学习的智能图片相似度检测软件，主要用于查找和清理计算机中的重复或高度相似的图片文件。本工具采用轻量级模型，能够在普通CPU上高效运行，无需GPU加速即可完成批量图片比对任务。

软件具有两个版本：
- **A版**：专门针对三次元（现实世界）图片优化，在真实照片（画面整体差异敏感）的相似度检测上表现优异
- **B版**：专门针对二次元（动漫/插画）图片优化，在动漫、插画等艺术作品（局部位置差异敏感）的相似度检测上效果更好

两个模型总和使用超过4万张图片数据进行训练，模型大小仅约2MB，在保证精度的同时实现较高的运行效率。

## ⭐主要特性

### 1. 扫描与比对过程
- 自动扫描当前文件夹及所有子文件夹中的图片文件
- 支持增量扫描：新增文件自动添加，已删除文件自动移除
- 注意:过程中会创建长期临时文件夹，该文件夹主要存放略缩图以及数据库，若删除可能会，导致断点功能和回收站失效，极端情况容易造成数据丢失，非必要情况请勿删除


### 2. 断点续扫功能
- **扫描功能**：首次扫描不支持断点续扫，后续扫描支持增量扫描
- **比对功能**：支持断点继续比对，比对到一半关闭软件后，重新打开可继续比对（每比较1000次自动保存一次进度）


### 3. 重复图片图片管理
- 分组显示相似图片，相同图片显示在同一组中
- 支持对组内图片进行多种操作：
  - 只保留组内某一张图片
  - 单独删除某张图片
  - 打开文件所在位置
  - 查看大图

### 4. 回收站系统
- 内置回收站功能，删除的图片会移动到临时文件夹的回收目录
- 支持从回收站还原文件到原位置或指定位置
- 支持彻底删除回收站中的文件

### 5.相似度阈值
- 在设置页面可调整相似度判定阈值
- A版和B版模型有不同的默认阈值范围
- 用户可根据需求调整阈值以达到不同的查重严格程度

## ⭐适用环境

### 系统要求
- **操作系统**：Windows 10（已测试），Windows 11（理论），macOS和Linux暂无打包版本
- **Python环境**：Python 3.8+（开发环境）
- **打包版本**：有

### 硬件要求
- **CPU**：4核以上
- **内存**：4GB以上
- **存储空间**：越多越好（需要足够的磁盘空间存储临时缩略图文件）
- **GPU加速**：不太支持

### 支持的图片格式
- PNG (.png)
- JPEG/JPG (.jpg, .jpeg)
- BMP (.bmp)
- WebP (.webp)
- TIFF (.tiff, .tif)
- GIF (.gif)

## ⭐使用详细步骤

### 第一步：放置软件
将软件（可执行文件或整个项目文件夹）放置在您要检测重复图片的文件夹根目录。

### 第二步：开始扫描
1. 启动软件，界面将显示四个主要页面：
   - 🔍 图片扫描：扫描控制页面
   - 🗑️ 回收站：管理已删除的图片
   - 🔄 重复图片：查看和管理相似图片组
   - ⚙️ 设置：调整软件参数

2. 点击"🔍 开始扫描图片"按钮
   - 软件将自动扫描当前文件夹及所有子文件夹中的图片
   - 首次扫描会创建缩略图并建立文件索引
   - 扫描过程中会在当前文件夹下创建 `_image_temp` 临时文件夹（不建议删除）

### 第三步：开始比对
1. 扫描完成后，点击"⚡ 开始比对重复"按钮
   - 软件将使用深度学习模型对所有图片进行两两比对
   - 比对过程支持断点继续：如果中途关闭软件，重新打开后可继续比对（应该）
   - 注意：如果文件有改动（增删改），比对进度会重置

### 第四步：管理重复图片
1. 比对完成后，切换到"🔄 重复图片"页面
2. 软件会将相似的图片分组显示
3. 对每个分组，您可以：
   - 点击缩略图查看大图
   - 点击"📁 打开文件夹"打开文件所在位置
   - 点击"💾 只保留这一张"保留该图片并移动组内其他图片到回收站
   - 点击"🗑️ 删除该张"将单张图片移动到回收站

### 第五步：使用回收站
1. 切换到"🗑️ 回收站"页面
2. 查看已删除的图片文件
3. 支持的操作：
   - 查看大图
   - 打开文件位置
   - 还原文件到原位置或指定位置
   - 彻底删除文件

## ⭐版本说明

### 手动构建
可通过修改 `image_viewer_gui.py` 中的 `RUN_Ver` 变量切换（打包版本已经固定）：
```python
RUN_Ver = 1  # 0 = A版，1 = B版
```
可通过修改 `image_viewer_gui.py`和`core_comparator.py` 中的 `MODEL_PATH = get_resource_path("tiny_similarity.pth")` 切换模型（打包版本已经固定）：
```python
MODEL_PATH = get_resource_path("tiny_similarity-A.pth") #A版模型
# MODEL_PATH = get_resource_path("tiny_similarity-B.pth") #B版模型
```


**A版模型（RUN_Ver = 0）**：
- 更适合处理三次元（现实世界）图片
- 默认相似度阈值：0.9974
- 阈值调整范围：0.3000 - 0.9974

**B版模型（RUN_Ver = 1）**：
- 更适合处理二次元（动漫/插画）图片
- 默认相似度阈值：0.9963
- 阈值调整范围：0.9600 - 0.9963

### 性能特点
- **模型大小**：仅约2MB，极轻量
- **训练数据**：使用超过4万张图片进行训练
- **运行效率**：无需GPU，普通CPU即可高效运行


## ⭐关于更多...

### 扫描机制
1. **首次扫描**：完整扫描所有文件夹，创建缩略图和文件索引
2. **后续扫描**：增量扫描，只处理新增或删除的文件
3. **临时文件**：在 `_image_temp` 文件夹中存储缩略图和数据库文件

### 比对机制
1. **断点续比**：每比对1000次自动保存进度，支持从中断处继续
2. **多进程支持**：CPU模式下使用多进程加速比对
3. **GPU加速**：支持CUDA和MPS加速（如果可用）
4. **相似度计算**：使用轻量级神经网络计算图片相似度

### 数据存储
- **数据库文件**：`_image_temp/db.json`，存储文件索引和比对结果
- **配置文件**：`_image_temp/config.json`，存储用户设置
- **缩略图**：`_image_temp/img_*.png`，存储处理后的图片缩略图
- **回收站**：`_image_temp/recycle_bin/`，存储已删除的图片文件
- **回收站索引**：`_image_temp/recycle_bin/index.js`，储存被回收文件的原路径


## ⭐常见问题

### Q1: 软件扫描速度慢怎么办？
A: 扫描速度受图片数量和大小影响。首次扫描需要创建缩略图，速度较慢；后续扫描为增量扫描，速度会快很多。

### Q2: 比对过程中可以中断吗？
A: 可以。软件每比对1000次会自动保存进度，中断后重新开始比对会从上次中断的位置继续。

### Q3: 临时文件夹可以删除吗？
A: 不建议删除 `_image_temp` 文件夹，其中包含扫描和比对的数据。如果一定要删除，可以使用软件内的"重置程序"功能。

### Q4: 如何调整查重的严格程度？
A: 在"设置"页面调整相似度阈值。阈值越高，查重越严格；阈值越低，查重越宽松。建议使用默认值就好，如需改动，可以先测试简单的场景在进行批量处理

### Q5: 支持哪些图片格式？
A: 支持 PNG、JPEG、BMP、WebP、TIFF、GIF 等常见图片格式。

### Q6: 可以在多个文件夹中使用吗？
A: 软件设计为在单个文件夹根目录运行。如果需要检测多个文件夹，建议将软件复制到每个文件夹中分别运行。


## ⭐注意事项
1. **文件位置**：软件必须放置在要检测的文件夹根目录
2. **临时文件**：`_image_temp` 文件夹对软件运行很重要，不要随便删除！不要随便删除！不要随便删除！
3. **文件改动**：如果在比对过程中文件有改动（增删改），比对进度会重置
4. **内存使用**：处理大量图片时，软件会占用较多内存，建议关闭其他大型程序
5. **备份重要文件**：在进行批量删除操作前，建议先备份重要文件


## ⭐开发背景
作为一个热爱收藏插画的用户，经常遇到一个问题，当在多设备上截图或者下载图片时，经常会无意中保存大量重复或高度相似的图片。随着时间的推移，这些重复图片不仅占用了宝贵的存储空间，也让整理和查找变得异常困难。

但是我特别喜欢收藏画师们的精美作品，但经常发现同一张图片在不同时间、不同设备上被重复下载，导致图片库越来越臃肿，手动查找和删除重复图片既耗时又容易出错，现有的查重工具要么功能复杂，要么效率低下。

正是基于这样的实际需求，我决定开发这款图片查重工具，最终这款工具终于诞生了，当然在开发过程中，它不仅解决了我个人的图片管理问题，也希望可以帮助到有同样困扰的其他用户。毕竟，美好的图片值得被高效地保存和管理，而不是被重复文件淹没。


## ⭐开发说明
如有问题或建议，请联系开发者。
在开发过程中，部分复杂的算法逻辑和代码实现借助了AI编程助手的帮助，真的是太方便了，爽！


**免责声明**：本软件按"原样"提供，不提供任何形式的明示或暗示保证。使用本软件造成的任何数据损失，开发者不承担责任。在进行重要操作前，请务必备份您的数据。

**许可证**：MIT License
